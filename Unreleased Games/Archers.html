<!--?xml version="1.0" encoding="UTF-8" ?-->
<html lang="en-us">
<head></head>
<body>
  <module>
    <moduleprefs title="-">
      <content type="html"><!--[CDATA[
<!DOCTYPE html-->
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/images-classroom-sources/ok@main/style.css">
        <!-- GameMonetize SDK Entegrasyonu -->
        <script id="gamemonetize-sdk" src="https://cdn.jsdelivr.net/gh/testamalame/sef@main/sedk.js"></script>
        <script type="text/javascript">
          window.SDK_OPTIONS = {
            gameId: "jp112o3o4hzgrnc7zaewjkrfk282pul8",
            onEvent: function (a) {
              switch (a.name) {
                case "SDK_GAME_PAUSE":
                  console.log("Oyun duraklatıldı, ses kapatılıyor...");
                  if (typeof window.unityInstance !== 'undefined' && window.unityInstance) {
                    window.unityInstance.SendMessage('AudioManager', 'MuteAudio');
                  }
                  break;
                case "SDK_GAME_START":
                  console.log("Reklam bitti, oyun devam ediyor...");
                  if (typeof window.unityInstance !== 'undefined' && window.unityInstance) {
                    window.unityInstance.SendMessage('AudioManager', 'UnmuteAudio');
                  }
                  break;
                case "SDK_READY":
                  console.log("SDK hazır.");
                  break;
              }
            }
          };
          (function (a, b, c) {
            var d = a.getElementsByTagName(b)[0];
            a.getElementById(c) || (a = a.createElement(b), a.id = c, a.src = "https://cdn.jsdelivr.net/gh/testamalame/sef@main/sedk.js", d.parentNode.insertBefore(a, d));
          })(document, "script", "gamemonetize-sdk");
        </script>

        <div id="unity-container" class="unity-desktop">
          <canvas id="unity-canvas" width="1897" height="467" style="cursor: default;"></canvas>
        </div>
        <div id="loading-cover" style="display: none;">
          <div id="unity-loading-bar">
            <div id="unity-logo"><img src="https://cdn.jsdelivr.net/gh/ertemr33/qaza@main/new.png"></div>
            <div class="progress-spinner-container">
              <div class="spinner-left"><img
                  src="https://cdn.jsdelivr.net/gh/images-classroom-sources/ok@main/spinner.png"></div>
              <div id="unity-progress-bar-empty">
                <div id="unity-progress-bar-full" style="width: 100%;"></div>
              </div>
              <div class="spinner-right"><img
                  src="https://cdn.jsdelivr.net/gh/images-classroom-sources/ok@main/spinner.png"></div>
            </div>
          </div>
        </div>
        <script>
          const buildUrl = "https://cdn.jsdelivr.net/gh/images-classroom-sources/ok@main/Build";
          const loaderUrl = buildUrl + "/v111.loader.js";
          const config = {
            dataUrl: buildUrl + "/6697b6deba8b617c67b69c55dcd07cb1.data.unityweb",
            frameworkUrl: buildUrl + "/0be3c3ee7115b26e1ae28e643afdf1f2.js.unityweb",
            codeUrl: buildUrl + "/b3397c29f6878557c1c614cbf9e196ea.wasm.unityweb",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "Ericetto",
            productName: "Ragdoll Archers",
            productVersion: "0.1",
          };

          const container = document.querySelector("#unity-container");
          const canvas = document.querySelector("#unity-canvas");
          const loadingCover = document.querySelector("#loading-cover");
          const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
          const progressBarFull = document.querySelector("#unity-progress-bar-full");

          let isAdShown = false;

          function showAdOnClick() {
            if (!isAdShown && typeof sdk !== 'undefined' && typeof sdk.showBanner !== 'undefined') {
              sdk.showBanner();
              isAdShown = true;
              console.log("Reklam çağrıldı.");
            } else {
              console.warn("SDK veya showBanner tanımlı değil.");
            }
          }

          if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
            container.className = "unity-mobile";
          }

          loadingCover.style.display = "";

          const unityLoader = document.createElement("script");
          unityLoader.src = loaderUrl;
          unityLoader.onload = () => {
            createUnityInstance(canvas, config, (progress) => {
              progressBarEmpty.style.display = "";
              progressBarFull.style.width = `${100 * progress}%`;
            }).then((unityInstance) => {
              window.unityInstance = unityInstance;
              loadingCover.style.display = "none";
              // Oyun yüklendiğinde tıklama olayını ekle
              canvas.addEventListener('pointerdown', showAdOnClick);
              canvas.addEventListener('touchstart', showAdOnClick);
            }).catch((message) => {
              alert(message);
            });
          };
          document.body.appendChild(unityLoader);

          document.addEventListener("pointerdown", () => {
            container.focus();
            window.focus();
            canvas.focus();
          });
        </script>

        <style>
          @keyframes pulse {

            0%,
            100% {
              transform: scale(1);
            }

            50% {
              transform: scale(1.05);
            }
          }

          /* Corner positions */
          .corner-top-left {
            top: 6px;
            left: 8px;
          }

          .corner-top-right {
            top: 6px;
            right: 8px;
          }

          .corner-bottom-left {
            bottom: 6px;
            left: 8px;
          }

          .corner-bottom-right {
            bottom: 6px;
            right: 8px;
          }

          /* Mobile adjustments */
          @media (max-width: 440px) {
            #ad-container {
              width: calc(100% - 20px);
              max-width: 360px;
            }
          }
        </style>

        <script>
          (function () {
            const initialDelay = 3000; // 3 saniye sonra ilk geri sayım başlar
            const realCloseDelay = 3000; // 3 saniye sonra gerçek kapatma butonu
            const countdownDuration = 3; // Geri sayım süresi (saniye)

            // Artan bekleme süreleri (milisaniye)
            // 1. tekrar: 3 dakika, 2. ve sonrası: 4 dakika
            const reappearDelays = [
              180000,  // 3 dakika (180.000 ms)
              240000   // 4 dakika (240.000 ms)
            ];

            let adShowCount = 0; // Kaç kez reklam gösterildi

            const adOverlay = document.getElementById('ad-overlay');
            const adContainer = document.getElementById('ad-container');
            const fakeClose = document.getElementById('fake-close');
            const realClose = document.getElementById('real-close');
            const adCountdown = document.getElementById('ad-countdown');
            const countdownNumber = adCountdown.querySelector('.countdown-number');

            const corners = [
              'corner-top-left',
              'corner-top-right',
              'corner-bottom-left',
              'corner-bottom-right'
            ];

            function clearCorners(element) {
              corners.forEach(corner => element.classList.remove(corner));
            }

            function getRandomCorner() {
              return corners[Math.floor(Math.random() * corners.length)];
            }

            function setRandomCorner(button) {
              clearCorners(button);
              button.classList.add(getRandomCorner());
            }

            // Mevcut bekleme süresini al
            function getCurrentDelay() {
              if (adShowCount <= 1) {
                return reappearDelays[0]; // 3 dakika
              } else {
                return reappearDelays[1]; // 4 dakika
              }
            }

            // Geri sayım fonksiyonu
            function startCountdown(callback) {
              let count = countdownDuration;

              adCountdown.style.display = 'block';
              countdownNumber.textContent = count;

              const interval = setInterval(() => {
                count--;

                if (count > 0) {
                  countdownNumber.textContent = count;
                } else {
                  clearInterval(interval);
                  adCountdown.style.display = 'none';
                  callback();
                }
              }, 1000);
            }

            function showAd() {
              adShowCount++;

              // Reset states
              adOverlay.classList.remove('fade-out');
              adContainer.classList.remove('fade-out');
              fakeClose.style.display = 'block';
              realClose.classList.remove('visible');
              realClose.style.display = 'none';

              setRandomCorner(fakeClose);

              adOverlay.style.display = 'block';
              adContainer.style.display = 'block';
              adContainer.setAttribute('aria-hidden', 'false');

              setTimeout(() => {
                fakeClose.style.display = 'none';
                setRandomCorner(realClose);
                realClose.style.display = 'block';
                realClose.offsetHeight;
                realClose.classList.add('visible');
              }, realCloseDelay);
            }

            // Geri sayımlı reklam gösterme
            function showAdWithCountdown() {
              startCountdown(() => {
                showAd();
              });
            }

            function closeAd() {
              adOverlay.classList.add('fade-out');
              adContainer.classList.add('fade-out');

              setTimeout(() => {
                adOverlay.style.display = 'none';
                adContainer.style.display = 'none';
                adContainer.setAttribute('aria-hidden', 'true');

                if (typeof window.focusGame === 'function') {
                  window.focusGame();
                }
              }, 400);

              // Sonraki reklam için zamanlama
              const nextDelay = getCurrentDelay();
              setTimeout(showAdWithCountdown, nextDelay);
            }

            // İLK REKLAM DA GERİ SAYIMLI
            // 3 saniye bekle, sonra geri sayım başlat
            setTimeout(showAdWithCountdown, initialDelay);

            realClose.addEventListener('click', closeAd);

            // Global fonksiyonlar
            window.showInterstitialAd = showAd;
            window.showInterstitialAdWithCountdown = showAdWithCountdown;
            window.closeInterstitialAd = closeAd;
          })();
        </script>
        ]]&gt;
      </content>
    </moduleprefs>
  </module>
  <script src="https://cdn.jsdelivr.net/gh/images-classroom-sources/ok@main/Build/v111.loader.js"></script>
  <script src="blob:https://28984253-atari-embeds.googleusercontent.com/1858b079-e1fd-4ad2-93d0-50bfc382b92f"></script>
</body>
</html>
